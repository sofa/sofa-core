/**
 * sofa-core - v0.7.0 - 2014-04-14
 * http://www.sofa.io
 *
 * Copyright (c) 2013 CouchCommerce GmbH (http://www.couchcommerce.org) and other contributors
 * THIS SOFTWARE CONTAINS COMPONENTS OF THE SOFA SDK (SOFA.IO).
 * IT IS PROVIDED UNDER THE LICENSE TERMS OF THE ATTACHED LICENSE.TXT.
 */
!function(a,b){"use strict";function c(a){if(null===a||d(a))return!1;var b=a.length;return 1===a.nodeType&&b?!0:f.Util.isString(a)||f.Util.isArray(a)||0===b||"number"==typeof b&&b>0&&b-1 in a}function d(a){return a&&a.document&&a.location&&a.alert&&a.setInterval}var e=a.cc={},f=a.sofa=e;f.namespace=function(a){var b,c=a.split("."),d=f;("cc"===c[0]||"sofa"===c[0])&&(c=c.slice(1));var e,g=f;for(b=0;b<c.length;b++)"undefined"==typeof d[c[b]]&&(d[c[b]]={}),b===c.length-2&&(g=d[c[b]]),e=c[b],d=d[c[b]];return{targetParent:g,targetName:e,bind:function(a){g[e]=a}}},f.define=function(a,b){f.namespace(a).bind(b)},f.inherits=function(a,b,c){c=c||{};var d={};[a.prototype,c].forEach(function(a){Object.getOwnPropertyNames(a).forEach(function(b){d[b]=Object.getOwnPropertyDescriptor(a,b)})}),a.prototype=Object.create(b.prototype,d),a.super=b},f.define("sofa.ConfigService",function(){var a={};return f.Config=f.Config||{},a.getSupportedCountries=function(){return f.Config.countries?f.Config.countries:[]},a.getDefaultCountry=function(){var b=a.getSupportedCountries();return 0===b.length?null:b[0]},a.getLocalizedPayPalButtonClass=function(b){return b?"cc-paypal-button--"+a.get("locale")+"--disabled":"cc-paypal-button--"+a.get("locale")},a.get=function(a,b){var c=f.Config[a];return f.Util.isUndefined(c)&&!f.Util.isUndefined(b)?b:c},a}),f.define("sofa.LocationService",function(){return{path:function(){return a.location.href}}}),f.define("sofa.models.BasketItem",function(){var a=this;return a.quantity=0,a}),f.models.BasketItem.prototype.getPrice=function(){return this.variant&&f.Util.isNumeric(this.variant.price)?this.variant.price:this.product.price},f.models.BasketItem.prototype.getTotal=function(){return f.Util.round(this.quantity*this.getPrice(),2)},f.models.BasketItem.prototype.getVariantID=function(){return this.variant?this.variant.variantID:null},f.models.BasketItem.prototype.getOptionID=function(){return this.variant?this.variant.optionID:null},f.define("sofa.models.Product",function(){}),f.models.Product.prototype.getImage=function(a){for(var b=0;b<this.images.length;b++)if(this.images[b].sizeName.toLowerCase()===a)return this.images[b].url;return f.Config.mediaPlaceholder},f.models.Product.prototype.getAllImages=function(){return this._allImages||(this._allImages=[{url:this.getImage("large")}].concat(this.imagesAlt)),this._allImages},f.models.Product.prototype.hasMultipleImages=function(){return this.getAllImages().length>0},f.models.Product.prototype.hasBasePrice=function(){return this.custom1>0},f.models.Product.prototype.getBasePriceStr=function(a){var b=this.custom1;return a&&(b=1/a.unitAmount*parseFloat(a.price)),f.Util.toFixed(b,2)},f.models.Product.prototype.hasUnit=function(){return f.Util.isString(this.custom3)&&this.custom3.length>0},f.models.Product.prototype.getUnit=function(){return this.custom3},f.models.Product.prototype.hasOldPrice=function(){return f.Util.isNumeric(this.priceOld)&&this.priceOld>0},f.models.Product.prototype.hasVariants=function(){return!!(this.variants&&this.variants.length>0)},f.models.Product.prototype.isOutOfStock=function(){return this.qty===b||null===this.qty?!1:!this.hasVariants()&&this.qty<=0||this.areAllVariantsOutOfStock()},f.models.Product.prototype.areAllVariantsOutOfStock=function(){return this.hasVariants()?f.Util.every(this.variants,function(a){return a.stock<=0}):!1},f.models.Product.prototype.hasAttributes=function(){return this.attributes&&Object.keys(this.attributes).length>0},f.define("sofa.Observable",function(){var a={mixin:function(a,b){return b={},a.on=function(c,d){return(b[c]=b[c]||[]).push(d),a},a.once=function(b,c){function d(){c.apply(a.off(b,d),arguments)}return d.h=c,a.on(b,d)},a.off=function(c,d){for(var e=b[c],f=0;d&&e&&e[f];f++)e[f]!==d&&e[f].h!==d||e.splice(f--,1);return f||delete b[c],a},a.emit=function(c){for(var d=b[c],e=0;d&&d[e];)d[e++].apply(a,d.slice.call(arguments,1));return a},a}};return a}),f.observable=new f.Observable,f.Util={isToFixedBroken:"1"!==.9.toFixed(),indicatorObject:{},objectTypes:{"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},domReady:function(b){"complete"===document.readyState?b():a.addEventListener("load",b,!1)},round:function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},toFixed:function(a,b){if(a=f.Util.isString(a)?parseFloat(a):a,f.Util.isToFixedBroken){b=b||0;var c=Math.pow(10,b);return(Math.round(a*c)/c).toFixed(b)}return a.toFixed(b)},clone:function(a){if(null===a||"object"!=typeof a)return a;var b;if(a instanceof Date)return b=new Date,b.setTime(a.getTime()),b;if(a instanceof Array){b=[];for(var c=0,d=a.length;d>c;c++)b[c]=this.clone(a[c]);return b}if(a instanceof Object){b={};for(var e in a)a.hasOwnProperty(e)&&(b[e]=this.clone(a[e]));return b}throw new Error("Unable to copy obj! Its type isn't supported.")},extend:function(a){for(var b=0;b<arguments.length;b++){var c=arguments[b];if(c!==a)for(var d in c)a[d]=c[d]}return a},createCallback:function(a,b,c){var d=typeof a;if("function"!==d){if("object"!==d)return function(b){return b[a]};var e=keys(a);return function(b){for(var c=e.length,d=!1;c--&&(d=isEqual(b[e[c]],a[e[c]],f.Util.indicatorObject)););return d}}return"undefined"==typeof b?a:1===c?function(c){return a.call(b,c)}:2===c?function(c,d){return a.call(b,c,d)}:4===c?function(c,d,e,f){return a.call(b,c,d,e,f)}:function(c,d,e){return a.call(b,c,d,e)}},findKey:function(a,b,c){var d;return b=f.Util.createCallback(b,c),f.Util.forOwn(a,function(a,c,e){return b(a,c,e)?(d=c,!1):void 0}),d},find:function(a,b,c){var d;return b=f.Util.createCallback(b,c),f.Util.forOwn(a,function(a,c,e){return b(a,c,e)?(d=a,!1):void 0}),d},every:function(a,b,c){var d=!0;return b=f.Util.createCallback(b,c),f.Util.forOwn(a,function(a,c,e){return b(a,c,e)?void 0:(d=!1,!1)}),d},forOwn:function(a,b){var c,d=a,e=d;if(!d)return e;if(!f.Util.objectTypes[typeof d])return e;for(c in d)if(Object.prototype.hasOwnProperty.call(d,c)&&b(d[c],c,a)===!1)return e;return e},debounce:function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=function(){d=null,c||(e=a.apply(f,g))},i=c&&!d;return clearTimeout(d),d=setTimeout(h,b),i&&(e=a.apply(f,g)),e}},isObject:function(a){return"object"==typeof a},isNumber:function(a){return"number"==typeof a},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isArray:function(a){return"[object Array]"===toString.call(a)},isFunction:function(a){return"function"==typeof a},isString:function(a){return"string"==typeof a},isUndefined:function(a){return"undefined"==typeof a},createGuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},Array:{remove:function(a,b){var c=a.indexOf(b);return a.splice(c,1),a}},toJson:function(a){if(!a||!a.length||a.length<2)return null;var b=a.substring(1,a.length-1);return JSON.parse(b)},toFormData:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},forEach:function(a,b,d){var e;if(a)if(f.Util.isFunction(a))for(e in a)a.hasOwnProperty(e)&&b.call(d,a[e],e);else if(a.forEach&&a.forEach!==f.Util.forEach)a.forEach(b,d);else if(c(a))for(e=0;e<a.length;e++)b.call(d,a[e],e);else for(e in a)a.hasOwnProperty(e)&&b.call(d,a[e],e);return a}},f.define("sofa.util.TreeIterator",function(a,b){var c=this,d=!0;c.iterateChildren=function(b){return d=!0,e(a,b)};var e=function(a,c,f){d=c(a,f),a[b]&&d!==!1&&a[b].forEach(function(b){d!==!1&&e(b,c,a)})}})}(window);